{"version":3,"sources":["assets\\Script\\scene\\gameGuanka.js"],"names":["cc","Class","Component","properties","scrollView","ScrollView","jiaose","Node","zhangLabel","Label","shangBtn","Button","xiaBtn","onDestroy","onLoad","list","game","localStorage","getItem","setItem","num","state","curNum","curZhang","parseInt","curGuan","guankazhangs","getComponentsInChildren","sort","a","b","zhangNodeList","curIndex","i","length","zhang","node","active","parent","content","items","item","setInfo","x","y","updateBtnState","string","interactable","updataMap","onShang","onXia"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        scrollView: cc.ScrollView,\r\n        jiaose: cc.Node,\r\n        zhangLabel: cc.Label,\r\n        shangBtn: cc.Button,\r\n        xiaBtn: cc.Button,\r\n    },\r\n    onDestroy() {\r\n    },\r\n    onLoad() {\r\n        let list = game.localStorage.getItem(\"guanka-data\");\r\n        if (!list) {\r\n            list = [];\r\n            game.localStorage.setItem(\"guanka-data\", list);\r\n        }\r\n        list = [\r\n            {num: 101, state: 3},\r\n            {num: 102, state: 2},\r\n            {num: 103, state: 2},\r\n            {num: 104, state: 1}\r\n        ]\r\n        game.curNum = game.localStorage.getItem(\"guanka-curGuan\") || 105;\r\n        game.curZhang = parseInt(game.curNum / 100);\r\n        game.curGuan = game.curNum % 100;\r\n        let guankazhangs = this.getComponentsInChildren(\"guankazhang\");\r\n        guankazhangs.sort(function (a, b) {\r\n            return a.num - b.num;\r\n        });\r\n        this.zhangNodeList = guankazhangs;\r\n        this.curIndex = 0;\r\n        for (let i = 0; i < guankazhangs.length; i++) {\r\n            let zhang = guankazhangs[i];\r\n            if (game.curZhang == zhang.num) {\r\n                zhang.node.active = true;\r\n                this.jiaose.parent = zhang.node;\r\n                this.curIndex = i;\r\n                this.scrollView.content = zhang.node;\r\n            }\r\n            else {\r\n                zhang.node.active = false;\r\n            }\r\n        }\r\n        game.localStorage.setItem(\"guanka-curNum\", game.curNum);\r\n        let items = this.getComponentsInChildren(\"guanItem\");\r\n        items.sort(function (a, b) {\r\n            return a.num - b.num;\r\n        })\r\n        for (let i = 0; i < items.length; i++) {\r\n            let item = items[i];\r\n            item.setInfo(list[i]);\r\n            if (item.num == game.curNum) {\r\n                this.jiaose.x = item.node.x;\r\n                this.jiaose.y = item.node.y + 50;\r\n            }\r\n        }\r\n        this.updateBtnState();\r\n    },\r\n    updateBtnState() {\r\n        this.zhangLabel.string = \"第\" + (this.curIndex + 1) + \"章\";\r\n        if (this.curIndex == 0 || this.zhangNodeList.length < 2) {\r\n            this.shangBtn.interactable = false;\r\n        }\r\n        else {\r\n            this.shangBtn.interactable = true;\r\n        }\r\n        if (this.curIndex >= (this.zhangNodeList.length - 1)) {\r\n            this.xiaBtn.interactable = false;\r\n        }\r\n        else {\r\n            this.xiaBtn.interactable = true;\r\n        }\r\n    },\r\n    updataMap() {\r\n        for (let i = 0; i < this.zhangNodeList.length; i++) {\r\n            let zhang = this.zhangNodeList[i];\r\n            if (i == this.curIndex) {\r\n                zhang.node.active = true;\r\n                this.curIndex = i;\r\n                this.scrollView.content = zhang.node;\r\n            }\r\n            else {\r\n                zhang.node.active = false;\r\n            }\r\n        }\r\n    },\r\n    onShang() {\r\n        var a = this.curIndex - 1;\r\n        if (a < 0) return;\r\n        this.curIndex = a;\r\n        this.updataMap();\r\n        this.updateBtnState();\r\n    },\r\n    onXia() {\r\n        var a = this.curIndex + 1;\r\n        if (a >= this.zhangNodeList.length) return;\r\n        this.curIndex = a;\r\n        this.updataMap();\r\n        this.updateBtnState();\r\n    },\r\n});\r\n"]}