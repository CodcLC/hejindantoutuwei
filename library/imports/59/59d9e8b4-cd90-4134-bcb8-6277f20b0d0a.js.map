{"version":3,"sources":["assets\\Script\\core\\min\\Stately.js"],"names":["root","factory","exports","module","define","amd","Stately","toString","Object","prototype","InvalidStateError","message","name","Error","constructor","statesObject","initialStateName","call","resolveSpecialEventFn","stateName","fnName","property","stateStore","hasOwnProperty","toLowerCase","currentState","getMachineState","setMachineState","nextState","eventName","arguments","onEnterState","onLeaveState","lastState","caller","getMachineEvents","events","push","stateMachine","transition","nextEvent","event","onBeforeEvent","onAfterEvent","eventValue","apply","length","test","machine"],"mappings":"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","sourceRoot":"/","sourcesContent":["/*\n * Stately.js: A JavaScript based finite-state machine (FSM) engine.\n *\n * Copyright (c) 2012 Florian Sch√§fer (florian.schaefer@gmail.com)\n * Released under MIT license.\n *\n * Version: 2.0.0\n *\n */\n(function (root, factory) {\n    if (typeof exports === 'object') {\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        define(factory);\n    } else {\n        root.Stately = factory();\n    }\n})(this, function () {\n\n    var\n        toString = Object.prototype.toString,\n\n        InvalidStateError = (function () {\n\n            function InvalidStateError(message) {\n\n                this.name = 'InvalidStateError';\n\n                this.message = message;\n            }\n\n            InvalidStateError.prototype = new Error();\n\n            InvalidStateError.prototype.constructor = InvalidStateError;\n\n            return InvalidStateError;\n        })();\n\n    function Stately(statesObject, initialStateName) {\n\n        if (typeof statesObject === 'function') {\n\n            statesObject = statesObject();\n        }\n\n        if (toString.call(statesObject) !== '[object Object]') {\n\n            throw new InvalidStateError('Stately.js: Invalid states object: `' + statesObject + '`.');\n        }\n\n        function resolveSpecialEventFn(stateName, fnName) {\n\n            for (var property in stateStore[stateName]) {\n\n                if (stateStore[stateName].hasOwnProperty(property)) {\n\n                    if (property.toLowerCase() === fnName.toLowerCase()) {\n\n                        return stateStore[stateName][property];\n\n                    }\n                }\n            }\n        }\n\n        var\n            currentState,\n\n            stateStore = {\n\n                getMachineState: function getMachineState() {\n\n                    return currentState.name;\n                },\n\n                setMachineState: function setMachineState(nextState /*, eventName */) {\n\n                    var\n                        eventName = arguments[1],\n\n                        onEnterState,\n\n                        onLeaveState,\n\n                        lastState = currentState;\n\n                    if (typeof nextState === 'string') {\n\n                        nextState = stateStore[nextState];\n\n                    }\n\n                    if (!nextState || !nextState.name || !stateStore[nextState.name]) {\n\n                        throw new InvalidStateError('Stately.js: Transitioned into invalid state: `' + setMachineState.caller + '`.');\n                    }\n\n                    currentState = nextState;\n\n                    onLeaveState = resolveSpecialEventFn(lastState.name, \"onLeave\");\n\n                    if (onLeaveState && typeof onLeaveState === 'function') {\n\n                        onLeaveState.call(stateStore, eventName, lastState.name, currentState.name);\n                    }\n\n                    onEnterState = resolveSpecialEventFn(currentState.name, \"onEnter\");\n\n                    if (onEnterState && typeof onEnterState === 'function') {\n\n                        onEnterState.call(stateStore, eventName, lastState.name, nextState.name);\n                    }\n\n                    return this;\n                },\n\n                getMachineEvents: function getMachineEvents() {\n\n                    var events = [];\n\n                    for (var property in currentState) {\n\n                        if (currentState.hasOwnProperty(property)) {\n\n                            if (typeof currentState[property] === 'function') {\n\n                                events.push(property);\n                            }\n                        }\n                    }\n\n                    return events;\n                }\n\n            },\n\n            stateMachine = {\n\n                getMachineState: stateStore.getMachineState,\n\n                getMachineEvents: stateStore.getMachineEvents\n\n            },\n\n            transition = function transition(stateName, eventName, nextEvent) {\n\n                return function event() {\n\n                    var\n                        onBeforeEvent,\n\n                        onAfterEvent,\n\n                        nextState,\n\n                        eventValue = stateMachine;\n\n                    if (stateStore[stateName] !== currentState) {\n\n                        if (nextEvent) {\n\n                            eventValue = nextEvent.apply(stateStore, arguments);\n                        }\n\n                        return eventValue;\n                    }\n\n                    onBeforeEvent = resolveSpecialEventFn(currentState.name, \"onBefore\" + eventName);\n\n                    if (onBeforeEvent && typeof onBeforeEvent === 'function') {\n\n                        onBeforeEvent.call(stateStore, eventName, currentState.name, currentState.name);\n                    }\n\n                    eventValue = stateStore[stateName][eventName].apply(stateStore, arguments);\n\n                    if (typeof eventValue === 'undefined') {\n\n                        nextState = currentState;\n\n                        eventValue = stateMachine;\n\n                    } else if (typeof eventValue === 'string') {\n\n                        nextState = stateStore[eventValue];\n\n                        eventValue = stateMachine;\n\n                    } else if (toString.call(eventValue) === '[object Object]') {\n\n                        nextState = (eventValue === stateStore ? currentState : eventValue);\n\n                        eventValue = stateMachine;\n\n                    } else if (toString.call(eventValue) === '[object Array]' && eventValue.length >= 1) {\n\n                        if (typeof eventValue[0] === 'string') {\n\n                            nextState = stateStore[eventValue[0]];\n\n                        } else {\n\n                            nextState = eventValue[0];\n\n                        }\n\n                        eventValue = eventValue[1];\n                    }\n\n                    onAfterEvent = resolveSpecialEventFn(currentState.name, \"onAfter\" + eventName);\n\n                    if (onAfterEvent && typeof onAfterEvent === 'function') {\n\n                        onAfterEvent.call(stateStore, eventName, currentState.name, nextState.name);\n                    }\n\n                    stateStore.setMachineState(nextState, eventName);\n\n                    return eventValue;\n                };\n            };\n\n        for (var stateName in statesObject) {\n\n            if (statesObject.hasOwnProperty(stateName)) {\n\n                stateStore[stateName] = statesObject[stateName];\n\n                for (var eventName in stateStore[stateName]) {\n\n                    if (stateStore[stateName].hasOwnProperty(eventName)) {\n\n                        if (typeof stateStore[stateName][eventName] === 'string') {\n\n                            stateStore[stateName][eventName] = (function (stateName) {\n\n                                return function event() {\n\n                                    return this[stateName];\n                                };\n\n                            })(stateStore[stateName][eventName]);\n                        }\n\n                        if (\n                            typeof stateStore[stateName][eventName] === 'function'\n                                && !/^onEnter$/i.test(eventName)\n                                && !/^onLeave$/i.test(eventName)\n                                && !/^onBefore/i.test(eventName)\n                                && !/^onAfter/i.test(eventName)\n                        ) {\n\n                            stateMachine[eventName] = transition(stateName, eventName, stateMachine[eventName]);\n                        }\n                    }\n                }\n\n                stateStore[stateName].name = stateName;\n\n                if (!currentState) {\n\n                    currentState = stateStore[stateName];\n                }\n            }\n        }\n\n        if (typeof stateStore[initialStateName] !== 'undefined') {\n            currentState = stateStore[initialStateName];\n        }\n\n        if (!currentState) {\n\n            throw new InvalidStateError('Stately.js: Invalid initial state.');\n        }\n\n        return stateMachine;\n    }\n\n    Stately.machine = function machine(statesObject, initialStateName) {\n        return new Stately(statesObject, initialStateName);\n    };\n\n    Stately.InvalidStateError = InvalidStateError;\n\n    return Stately;\n\n});\n"]}