
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/core/min/Stately.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '59d9ei0zZBBNLy4YnfyCw0K', 'Stately');
// Script/core/min/Stately.js

"use strict";

/*
 * Stately.js: A JavaScript based finite-state machine (FSM) engine.
 *
 * Copyright (c) 2012 Florian SchÃ¤fer (florian.schaefer@gmail.com)
 * Released under MIT license.
 *
 * Version: 2.0.0
 *
 */
(function (root, factory) {
  if (typeof exports === 'object') {
    module.exports = factory();
  } else if (typeof define === 'function' && define.amd) {
    define(factory);
  } else {
    root.Stately = factory();
  }
})(void 0, function () {
  var toString = Object.prototype.toString,
      InvalidStateError = function () {
    function InvalidStateError(message) {
      this.name = 'InvalidStateError';
      this.message = message;
    }

    InvalidStateError.prototype = new Error();
    InvalidStateError.prototype.constructor = InvalidStateError;
    return InvalidStateError;
  }();

  function Stately(statesObject, initialStateName) {
    if (typeof statesObject === 'function') {
      statesObject = statesObject();
    }

    if (toString.call(statesObject) !== '[object Object]') {
      throw new InvalidStateError('Stately.js: Invalid states object: `' + statesObject + '`.');
    }

    function resolveSpecialEventFn(stateName, fnName) {
      for (var property in stateStore[stateName]) {
        if (stateStore[stateName].hasOwnProperty(property)) {
          if (property.toLowerCase() === fnName.toLowerCase()) {
            return stateStore[stateName][property];
          }
        }
      }
    }

    var currentState,
        stateStore = {
      getMachineState: function getMachineState() {
        return currentState.name;
      },
      setMachineState: function setMachineState(nextState
      /*, eventName */
      ) {
        var eventName = arguments[1],
            onEnterState,
            onLeaveState,
            lastState = currentState;

        if (typeof nextState === 'string') {
          nextState = stateStore[nextState];
        }

        if (!nextState || !nextState.name || !stateStore[nextState.name]) {
          throw new InvalidStateError('Stately.js: Transitioned into invalid state: `' + setMachineState.caller + '`.');
        }

        currentState = nextState;
        onLeaveState = resolveSpecialEventFn(lastState.name, "onLeave");

        if (onLeaveState && typeof onLeaveState === 'function') {
          onLeaveState.call(stateStore, eventName, lastState.name, currentState.name);
        }

        onEnterState = resolveSpecialEventFn(currentState.name, "onEnter");

        if (onEnterState && typeof onEnterState === 'function') {
          onEnterState.call(stateStore, eventName, lastState.name, nextState.name);
        }

        return this;
      },
      getMachineEvents: function getMachineEvents() {
        var events = [];

        for (var property in currentState) {
          if (currentState.hasOwnProperty(property)) {
            if (typeof currentState[property] === 'function') {
              events.push(property);
            }
          }
        }

        return events;
      }
    },
        stateMachine = {
      getMachineState: stateStore.getMachineState,
      getMachineEvents: stateStore.getMachineEvents
    },
        transition = function transition(stateName, eventName, nextEvent) {
      return function event() {
        var onBeforeEvent,
            onAfterEvent,
            nextState,
            eventValue = stateMachine;

        if (stateStore[stateName] !== currentState) {
          if (nextEvent) {
            eventValue = nextEvent.apply(stateStore, arguments);
          }

          return eventValue;
        }

        onBeforeEvent = resolveSpecialEventFn(currentState.name, "onBefore" + eventName);

        if (onBeforeEvent && typeof onBeforeEvent === 'function') {
          onBeforeEvent.call(stateStore, eventName, currentState.name, currentState.name);
        }

        eventValue = stateStore[stateName][eventName].apply(stateStore, arguments);

        if (typeof eventValue === 'undefined') {
          nextState = currentState;
          eventValue = stateMachine;
        } else if (typeof eventValue === 'string') {
          nextState = stateStore[eventValue];
          eventValue = stateMachine;
        } else if (toString.call(eventValue) === '[object Object]') {
          nextState = eventValue === stateStore ? currentState : eventValue;
          eventValue = stateMachine;
        } else if (toString.call(eventValue) === '[object Array]' && eventValue.length >= 1) {
          if (typeof eventValue[0] === 'string') {
            nextState = stateStore[eventValue[0]];
          } else {
            nextState = eventValue[0];
          }

          eventValue = eventValue[1];
        }

        onAfterEvent = resolveSpecialEventFn(currentState.name, "onAfter" + eventName);

        if (onAfterEvent && typeof onAfterEvent === 'function') {
          onAfterEvent.call(stateStore, eventName, currentState.name, nextState.name);
        }

        stateStore.setMachineState(nextState, eventName);
        return eventValue;
      };
    };

    for (var stateName in statesObject) {
      if (statesObject.hasOwnProperty(stateName)) {
        stateStore[stateName] = statesObject[stateName];

        for (var eventName in stateStore[stateName]) {
          if (stateStore[stateName].hasOwnProperty(eventName)) {
            if (typeof stateStore[stateName][eventName] === 'string') {
              stateStore[stateName][eventName] = function (stateName) {
                return function event() {
                  return this[stateName];
                };
              }(stateStore[stateName][eventName]);
            }

            if (typeof stateStore[stateName][eventName] === 'function' && !/^onEnter$/i.test(eventName) && !/^onLeave$/i.test(eventName) && !/^onBefore/i.test(eventName) && !/^onAfter/i.test(eventName)) {
              stateMachine[eventName] = transition(stateName, eventName, stateMachine[eventName]);
            }
          }
        }

        stateStore[stateName].name = stateName;

        if (!currentState) {
          currentState = stateStore[stateName];
        }
      }
    }

    if (typeof stateStore[initialStateName] !== 'undefined') {
      currentState = stateStore[initialStateName];
    }

    if (!currentState) {
      throw new InvalidStateError('Stately.js: Invalid initial state.');
    }

    return stateMachine;
  }

  Stately.machine = function machine(statesObject, initialStateName) {
    return new Stately(statesObject, initialStateName);
  };

  Stately.InvalidStateError = InvalidStateError;
  return Stately;
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxjb3JlXFxtaW5cXFN0YXRlbHkuanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwiU3RhdGVseSIsInRvU3RyaW5nIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiSW52YWxpZFN0YXRlRXJyb3IiLCJtZXNzYWdlIiwibmFtZSIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJzdGF0ZXNPYmplY3QiLCJpbml0aWFsU3RhdGVOYW1lIiwiY2FsbCIsInJlc29sdmVTcGVjaWFsRXZlbnRGbiIsInN0YXRlTmFtZSIsImZuTmFtZSIsInByb3BlcnR5Iiwic3RhdGVTdG9yZSIsImhhc093blByb3BlcnR5IiwidG9Mb3dlckNhc2UiLCJjdXJyZW50U3RhdGUiLCJnZXRNYWNoaW5lU3RhdGUiLCJzZXRNYWNoaW5lU3RhdGUiLCJuZXh0U3RhdGUiLCJldmVudE5hbWUiLCJhcmd1bWVudHMiLCJvbkVudGVyU3RhdGUiLCJvbkxlYXZlU3RhdGUiLCJsYXN0U3RhdGUiLCJjYWxsZXIiLCJnZXRNYWNoaW5lRXZlbnRzIiwiZXZlbnRzIiwicHVzaCIsInN0YXRlTWFjaGluZSIsInRyYW5zaXRpb24iLCJuZXh0RXZlbnQiLCJldmVudCIsIm9uQmVmb3JlRXZlbnQiLCJvbkFmdGVyRXZlbnQiLCJldmVudFZhbHVlIiwiYXBwbHkiLCJsZW5ndGgiLCJ0ZXN0IiwibWFjaGluZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLFVBQVVBLElBQVYsRUFBZ0JDLE9BQWhCLEVBQXlCO0FBQ3RCLE1BQUksT0FBT0MsT0FBUCxLQUFtQixRQUF2QixFQUFpQztBQUM3QkMsSUFBQUEsTUFBTSxDQUFDRCxPQUFQLEdBQWlCRCxPQUFPLEVBQXhCO0FBQ0gsR0FGRCxNQUVPLElBQUksT0FBT0csTUFBUCxL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QU9HLFVBQVUsQ0FBQ04sZ0JBQUQsQ0FBakIsS0FBd0MsV0FBNUMsRUFBeUQ7QUFDckRTLE1BQUFBLFlBQVksR0FBR0gsVUFBVSxDQUFDTixnQkFBRCxDQUF6QjtBQUNIOztBQUVELFFBQUksQ0FBQ1MsWUFBTCxFQUFtQjtBQUVmLFlBQU0sSUFBSWYsaUJBQUosQ0FBc0Isb0NBQXRCLENBQU47QUFDSDs7QUFFRCxXQUFPNEIsWUFBUDtBQUNIOztBQUVEaEMsRUFBQUEsT0FBTyxDQUFDMEMsT0FBUixHQUFrQixTQUFTQSxPQUFULENBQWlCakMsWUFBakIsRUFBK0JDLGdCQUEvQixFQUFpRDtBQUMvRCxXQUFPLElBQUlWLE9BQUosQ0FBWVMsWUFBWixFQUEwQkMsZ0JBQTFCLENBQVA7QUFDSCxHQUZEOztBQUlBVixFQUFBQSxPQUFPLENBQUNJLGlCQUFSLEdBQTRCQSxpQkFBNUI7QUFFQSxTQUFPSixPQUFQO0FBRUgsQ0FyUkQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBTdGF0ZWx5LmpzOiBBIEphdmFTY3JpcHQgYmFzZWQgZmluaXRlLXN0YXRlIG1hY2hpbmUgKEZTTSkgZW5naW5lLlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMiBGbG9yaWFuIFNjaMOkZmVyIChmbG9yaWFuLnNjaGFlZmVyQGdtYWlsLmNvbSlcbiAqIFJlbGVhc2VkIHVuZGVyIE1JVCBsaWNlbnNlLlxuICpcbiAqIFZlcnNpb246IDIuMC4wXG4gKlxuICovXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShmYWN0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByb290LlN0YXRlbHkgPSBmYWN0b3J5KCk7XG4gICAgfVxufSkodGhpcywgZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyXG4gICAgICAgIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcblxuICAgICAgICBJbnZhbGlkU3RhdGVFcnJvciA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIEludmFsaWRTdGF0ZUVycm9yKG1lc3NhZ2UpIHtcblxuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9ICdJbnZhbGlkU3RhdGVFcnJvcic7XG5cbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBJbnZhbGlkU3RhdGVFcnJvci5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTtcblxuICAgICAgICAgICAgSW52YWxpZFN0YXRlRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSW52YWxpZFN0YXRlRXJyb3I7XG5cbiAgICAgICAgICAgIHJldHVybiBJbnZhbGlkU3RhdGVFcnJvcjtcbiAgICAgICAgfSkoKTtcblxuICAgIGZ1bmN0aW9uIFN0YXRlbHkoc3RhdGVzT2JqZWN0LCBpbml0aWFsU3RhdGVOYW1lKSB7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBzdGF0ZXNPYmplY3QgPT09ICdmdW5jdGlvbicpIHtcblxuICAgICAgICAgICAgc3RhdGVzT2JqZWN0ID0gc3RhdGVzT2JqZWN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodG9TdHJpbmcuY2FsbChzdGF0ZXNPYmplY3QpICE9PSAnW29iamVjdCBPYmplY3RdJykge1xuXG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXJyb3IoJ1N0YXRlbHkuanM6IEludmFsaWQgc3RhdGVzIG9iamVjdDogYCcgKyBzdGF0ZXNPYmplY3QgKyAnYC4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlc29sdmVTcGVjaWFsRXZlbnRGbihzdGF0ZU5hbWUsIGZuTmFtZSkge1xuXG4gICAgICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBzdGF0ZVN0b3JlW3N0YXRlTmFtZV0pIHtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZVN0b3JlW3N0YXRlTmFtZV0uaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5LnRvTG93ZXJDYXNlKCkgPT09IGZuTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZVN0b3JlW3N0YXRlTmFtZV1bcHJvcGVydHldO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXJcbiAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSxcblxuICAgICAgICAgICAgc3RhdGVTdG9yZSA9IHtcblxuICAgICAgICAgICAgICAgIGdldE1hY2hpbmVTdGF0ZTogZnVuY3Rpb24gZ2V0TWFjaGluZVN0YXRlKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50U3RhdGUubmFtZTtcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgc2V0TWFjaGluZVN0YXRlOiBmdW5jdGlvbiBzZXRNYWNoaW5lU3RhdGUobmV4dFN0YXRlIC8qLCBldmVudE5hbWUgKi8pIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZSA9IGFyZ3VtZW50c1sxXSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgb25FbnRlclN0YXRlLFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkxlYXZlU3RhdGUsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RTdGF0ZSA9IGN1cnJlbnRTdGF0ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG5leHRTdGF0ZSA9PT0gJ3N0cmluZycpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gc3RhdGVTdG9yZVtuZXh0U3RhdGVdO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoIW5leHRTdGF0ZSB8fCAhbmV4dFN0YXRlLm5hbWUgfHwgIXN0YXRlU3RvcmVbbmV4dFN0YXRlLm5hbWVdKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFcnJvcignU3RhdGVseS5qczogVHJhbnNpdGlvbmVkIGludG8gaW52YWxpZCBzdGF0ZTogYCcgKyBzZXRNYWNoaW5lU3RhdGUuY2FsbGVyICsgJ2AuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSBuZXh0U3RhdGU7XG5cbiAgICAgICAgICAgICAgICAgICAgb25MZWF2ZVN0YXRlID0gcmVzb2x2ZVNwZWNpYWxFdmVudEZuKGxhc3RTdGF0ZS5uYW1lLCBcIm9uTGVhdmVcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9uTGVhdmVTdGF0ZSAmJiB0eXBlb2Ygb25MZWF2ZVN0YXRlID09PSAnZnVuY3Rpb24nKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uTGVhdmVTdGF0ZS5jYWxsKHN0YXRlU3RvcmUsIGV2ZW50TmFtZSwgbGFzdFN0YXRlLm5hbWUsIGN1cnJlbnRTdGF0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG9uRW50ZXJTdGF0ZSA9IHJlc29sdmVTcGVjaWFsRXZlbnRGbihjdXJyZW50U3RhdGUubmFtZSwgXCJvbkVudGVyXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkVudGVyU3RhdGUgJiYgdHlwZW9mIG9uRW50ZXJTdGF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkVudGVyU3RhdGUuY2FsbChzdGF0ZVN0b3JlLCBldmVudE5hbWUsIGxhc3RTdGF0ZS5uYW1lLCBuZXh0U3RhdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgZ2V0TWFjaGluZUV2ZW50czogZnVuY3Rpb24gZ2V0TWFjaGluZUV2ZW50cygpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gY3VycmVudFN0YXRlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUuaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnRTdGF0ZVtwcm9wZXJ0eV0gPT09ICdmdW5jdGlvbicpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHMucHVzaChwcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50cztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHN0YXRlTWFjaGluZSA9IHtcblxuICAgICAgICAgICAgICAgIGdldE1hY2hpbmVTdGF0ZTogc3RhdGVTdG9yZS5nZXRNYWNoaW5lU3RhdGUsXG5cbiAgICAgICAgICAgICAgICBnZXRNYWNoaW5lRXZlbnRzOiBzdGF0ZVN0b3JlLmdldE1hY2hpbmVFdmVudHNcblxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdHJhbnNpdGlvbiA9IGZ1bmN0aW9uIHRyYW5zaXRpb24oc3RhdGVOYW1lLCBldmVudE5hbWUsIG5leHRFdmVudCkge1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGV2ZW50KCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICAgICAgICAgICAgb25CZWZvcmVFdmVudCxcblxuICAgICAgICAgICAgICAgICAgICAgICAgb25BZnRlckV2ZW50LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0U3RhdGUsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VmFsdWUgPSBzdGF0ZU1hY2hpbmU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlU3RvcmVbc3RhdGVOYW1lXSAhPT0gY3VycmVudFN0YXRlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0RXZlbnQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VmFsdWUgPSBuZXh0RXZlbnQuYXBwbHkoc3RhdGVTdG9yZSwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBvbkJlZm9yZUV2ZW50ID0gcmVzb2x2ZVNwZWNpYWxFdmVudEZuKGN1cnJlbnRTdGF0ZS5uYW1lLCBcIm9uQmVmb3JlXCIgKyBldmVudE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkJlZm9yZUV2ZW50ICYmIHR5cGVvZiBvbkJlZm9yZUV2ZW50ID09PSAnZnVuY3Rpb24nKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQmVmb3JlRXZlbnQuY2FsbChzdGF0ZVN0b3JlLCBldmVudE5hbWUsIGN1cnJlbnRTdGF0ZS5uYW1lLCBjdXJyZW50U3RhdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBldmVudFZhbHVlID0gc3RhdGVTdG9yZVtzdGF0ZU5hbWVdW2V2ZW50TmFtZV0uYXBwbHkoc3RhdGVTdG9yZSwgYXJndW1lbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGV2ZW50VmFsdWUgPT09ICd1bmRlZmluZWQnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRTdGF0ZSA9IGN1cnJlbnRTdGF0ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRWYWx1ZSA9IHN0YXRlTWFjaGluZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFZhbHVlID09PSAnc3RyaW5nJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0U3RhdGUgPSBzdGF0ZVN0b3JlW2V2ZW50VmFsdWVdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudFZhbHVlID0gc3RhdGVNYWNoaW5lO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodG9TdHJpbmcuY2FsbChldmVudFZhbHVlKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gKGV2ZW50VmFsdWUgPT09IHN0YXRlU3RvcmUgPyBjdXJyZW50U3RhdGUgOiBldmVudFZhbHVlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRWYWx1ZSA9IHN0YXRlTWFjaGluZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRvU3RyaW5nLmNhbGwoZXZlbnRWYWx1ZSkgPT09ICdbb2JqZWN0IEFycmF5XScgJiYgZXZlbnRWYWx1ZS5sZW5ndGggPj0gMSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGV2ZW50VmFsdWVbMF0gPT09ICdzdHJpbmcnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0U3RhdGUgPSBzdGF0ZVN0b3JlW2V2ZW50VmFsdWVbMF1dO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlID0gZXZlbnRWYWx1ZVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudFZhbHVlID0gZXZlbnRWYWx1ZVsxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG9uQWZ0ZXJFdmVudCA9IHJlc29sdmVTcGVjaWFsRXZlbnRGbihjdXJyZW50U3RhdGUubmFtZSwgXCJvbkFmdGVyXCIgKyBldmVudE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkFmdGVyRXZlbnQgJiYgdHlwZW9mIG9uQWZ0ZXJFdmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkFmdGVyRXZlbnQuY2FsbChzdGF0ZVN0b3JlLCBldmVudE5hbWUsIGN1cnJlbnRTdGF0ZS5uYW1lLCBuZXh0U3RhdGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVN0b3JlLnNldE1hY2hpbmVTdGF0ZShuZXh0U3RhdGUsIGV2ZW50TmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50VmFsdWU7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgc3RhdGVOYW1lIGluIHN0YXRlc09iamVjdCkge1xuXG4gICAgICAgICAgICBpZiAoc3RhdGVzT2JqZWN0Lmhhc093blByb3BlcnR5KHN0YXRlTmFtZSkpIHtcblxuICAgICAgICAgICAgICAgIHN0YXRlU3RvcmVbc3RhdGVOYW1lXSA9IHN0YXRlc09iamVjdFtzdGF0ZU5hbWVdO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZXZlbnROYW1lIGluIHN0YXRlU3RvcmVbc3RhdGVOYW1lXSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZVN0b3JlW3N0YXRlTmFtZV0uaGFzT3duUHJvcGVydHkoZXZlbnROYW1lKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlU3RvcmVbc3RhdGVOYW1lXVtldmVudE5hbWVdID09PSAnc3RyaW5nJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVTdG9yZVtzdGF0ZU5hbWVdW2V2ZW50TmFtZV0gPSAoZnVuY3Rpb24gKHN0YXRlTmFtZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBldmVudCgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbc3RhdGVOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKHN0YXRlU3RvcmVbc3RhdGVOYW1lXVtldmVudE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBzdGF0ZVN0b3JlW3N0YXRlTmFtZV1bZXZlbnROYW1lXSA9PT0gJ2Z1bmN0aW9uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhL15vbkVudGVyJC9pLnRlc3QoZXZlbnROYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhL15vbkxlYXZlJC9pLnRlc3QoZXZlbnROYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhL15vbkJlZm9yZS9pLnRlc3QoZXZlbnROYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhL15vbkFmdGVyL2kudGVzdChldmVudE5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlTWFjaGluZVtldmVudE5hbWVdID0gdHJhbnNpdGlvbihzdGF0ZU5hbWUsIGV2ZW50TmFtZSwgc3RhdGVNYWNoaW5lW2V2ZW50TmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RhdGVTdG9yZVtzdGF0ZU5hbWVdLm5hbWUgPSBzdGF0ZU5hbWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRTdGF0ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9IHN0YXRlU3RvcmVbc3RhdGVOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIHN0YXRlU3RvcmVbaW5pdGlhbFN0YXRlTmFtZV0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjdXJyZW50U3RhdGUgPSBzdGF0ZVN0b3JlW2luaXRpYWxTdGF0ZU5hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjdXJyZW50U3RhdGUpIHtcblxuICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUVycm9yKCdTdGF0ZWx5LmpzOiBJbnZhbGlkIGluaXRpYWwgc3RhdGUuJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RhdGVNYWNoaW5lO1xuICAgIH1cblxuICAgIFN0YXRlbHkubWFjaGluZSA9IGZ1bmN0aW9uIG1hY2hpbmUoc3RhdGVzT2JqZWN0LCBpbml0aWFsU3RhdGVOYW1lKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3RhdGVseShzdGF0ZXNPYmplY3QsIGluaXRpYWxTdGF0ZU5hbWUpO1xuICAgIH07XG5cbiAgICBTdGF0ZWx5LkludmFsaWRTdGF0ZUVycm9yID0gSW52YWxpZFN0YXRlRXJyb3I7XG5cbiAgICByZXR1cm4gU3RhdGVseTtcblxufSk7XG4iXX0=