{"version":3,"sources":["assets\\Script\\zhujie\\roleHp.js"],"names":["HpComponent","require","cc","Class","properties","progressBar","ProgressBar","totalHp","onHurt","value","curHp","isShow","node","opacity","showTime","updateBar","emit","parent","onDestroy","progress","format","game","onCollisionEnter","other","self","hurt","getComponent","hurtValue","end","onCollisionStay","onCollisionExit","onLoad","weaponData","hp","start","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["let HpComponent = require(\"hpComponent\"); //池子组件\r\ncc.Class({\r\n    extends: HpComponent,\r\n    properties: {\r\n        progressBar: cc.ProgressBar,\r\n        totalHp: 1000\r\n    },\r\n    //受到的伤害\r\n    onHurt(value) {\r\n        this.curHp -= value;\r\n        this.isShow = true;\r\n        this.progressBar.node.opacity = 255;\r\n        this.showTime = 0;\r\n        this.updateBar();\r\n        if (this.curHp <= 0) {\r\n            this.node.emit(\"death\");\r\n            this.parent.emit(\"death\");\r\n        }\r\n    },\r\n    onDestroy() {\r\n    },\r\n    updateBar() {\r\n        var progress = (this.curHp / this.totalHp).format();\r\n        this.progressBar.progress = progress;\r\n        game.emit(\"zhujiaoXue\", this.curHp, this.totalHp);\r\n    },\r\n    //碰撞检测到\r\n    onCollisionEnter: function (other, self) {\r\n        var hurt = other.node.getComponent(\"hurt\");\r\n        if (!hurt || hurt.hurtValue == 0) return;\r\n        this.curHp -= hurt.hurtValue;\r\n        hurt.end();\r\n        this.isShow = true;\r\n        this.progressBar.node.opacity = 255;\r\n        this.showTime = 0;\r\n        this.updateBar();\r\n        if (this.curHp <= 0) {\r\n            this.node.emit(\"death\");\r\n            this.parent.emit(\"death\");\r\n        }\r\n    },\r\n    onCollisionStay: function (other, self) {\r\n    },\r\n    //碰撞退出\r\n    onCollisionExit: function (other, self) {\r\n        // cc.log(\"碰撞退出\")\r\n    },\r\n    onLoad() {\r\n        var weaponData = require(\"zhujueConfig\");\r\n        this.totalHp = weaponData.hp;\r\n        this.curHp = this.totalHp;\r\n        this.parent = this.node.parent;\r\n        this.updateBar();\r\n        this.showTime = 0;\r\n        this.isShow = false;\r\n        this.progressBar.node.opacity = 0;\r\n    },\r\n    start() {\r\n    },\r\n    update(dt) {\r\n        this.showTime += dt;\r\n        if (this.isShow && this.showTime > 2) {\r\n            this.isShow = false;\r\n            this.progressBar.node.opacity = 0;\r\n        }\r\n    },\r\n});\r\n"]}