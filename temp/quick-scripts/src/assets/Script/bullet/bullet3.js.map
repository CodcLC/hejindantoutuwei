{"version":3,"sources":["assets\\Script\\bullet\\bullet3.js"],"names":["PoolComponent","require","cc","Class","properties","head","Animation","onLoad","unuse","reuse","data","game","soundManager","playEffect","gameSound","zhong_xing_qiang_jie5","init","group","node","angle","hd","Math","PI","speedX","cos","width","speedY","sin","x","v","y","_isinit","spriteFrames","gameUtils","getSpriteFrames","bullet_atlas","startClip","AnimationClip","createWithSpriteFrames","name","wrapMode","WrapMode","Normal","addClip","playAdditive","animation","getComponent","prefabName","flashClip","once","pool","put","removeFromParent","destroy","bind","start","onDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["let PoolComponent = require(\"PoolComponent\"); //池子组件\r\ncc.Class({\r\n    extends: PoolComponent,\r\n    properties: {\r\n        head: cc.Animation,\r\n    },\r\n    onLoad() {\r\n    },\r\n    //回收\r\n    unuse: function () {\r\n    },\r\n    //重用\r\n    reuse: function (data) {\r\n        game.soundManager.playEffect(game.gameSound.zhong_xing_qiang_jie5, false);\r\n        this.init(data);\r\n    },\r\n    init(data) {\r\n        if (data.group) this.node.group = data.group;\r\n        this.node.angle = data.angle;\r\n        let hd = this.node.angle * Math.PI / 180;\r\n        this.speedX = Math.cos(hd) * (this.node.width / 2 + this.head.node.width);\r\n        this.speedY = Math.sin(hd) * (this.node.width / 2 + this.head.node.width);\r\n        this.node.x = data.v.x + this.speedX;\r\n        this.node.y = data.v.y + this.speedY;\r\n        //闪电头子动画\r\n        if (!this._isinit) {\r\n            let spriteFrames = game.gameUtils.getSpriteFrames(game.bullet_atlas, \"flashHead\");\r\n            let startClip = cc.AnimationClip.createWithSpriteFrames(spriteFrames, 30);\r\n            startClip.name = 'start';\r\n            startClip.wrapMode = cc.WrapMode.Normal;\r\n            this.head.addClip(startClip);\r\n        }\r\n        this.head.playAdditive('start', 0);\r\n        //自身动画\r\n        let animation = this.node.getComponent(cc.Animation);//动画组件\r\n        if (!this._isinit) {\r\n            let spriteFrames = game.gameUtils.getSpriteFrames(game.bullet_atlas, data.prefabName);\r\n            let flashClip = cc.AnimationClip.createWithSpriteFrames(spriteFrames, 20);\r\n            flashClip.name = 'flash';\r\n            flashClip.wrapMode = cc.WrapMode.Normal;\r\n            animation.addClip(flashClip);\r\n        }\r\n        animation.playAdditive('flash', 0);\r\n        animation.once(\"finished\", function () {\r\n            let pool = this.node.pool;\r\n            if (pool) {\r\n                pool.put(this.node);\r\n            }\r\n            else {\r\n                this.node.removeFromParent(true);\r\n                this.node.destroy();\r\n            }\r\n        }.bind(this));\r\n    },\r\n    start() {\r\n    },\r\n    onDestroy() {\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}