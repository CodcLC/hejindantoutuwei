{"version":3,"sources":["assets\\Script\\core\\min\\jm.js"],"names":["jm","_","require","root","registries","module","exports","Class","fnTest","test","xyz","extend","prop","_super","prototype","Object","create","name","fn","tmp","ret","apply","arguments","properties","key","desc","get","set","defineProperty","_className","value","writable","ctor","constructor","attr","attrs","object","Random","iRandomMax","seed","opts","g_seed","randomMax","setSeed","getSeed","random","randomInt","min","max","undefined","range","Math","round","randomDouble","randomRange","randomOdds","odds","EventEmitter","_events","_persistEvents","addListener","on","__createListener","caller","__equalsListener","listener1","listener2","listener","Array","isArray","push","onPersist","once","self","arg1","arg2","arg3","arg4","arg5","removeListener","call","list","pos","i","l","length","o","splice","removePersistListener","delListener","concat","removeAllListeners","listeners","emit","_emitPersist","handler","h","eventEmitter","event","off","removeEventListener","em","enableEvent","obj","disableEvent","TagObject","_tags","destroy","removeAllTags","hasTag","tag","tags","indexOf","hasTagAny","t","hasTagAll","addTag","addTags","removeTag","idx","removeTags","v","tagObject","Tag","enableTag","disableTag","Entity","guid","isEmptyObject","e","entityManager","_components","_componentsByClass","_componentGUID","active","entityId","_entitiesByTag","removeAllComponents","removeChild","removeEntity","children","without","removeFromParent","parent","addComponent","c","components","componentsByClass","cClassName","className","bUsedName","singleton","vByClass","classAlias","onAdd","removeComponent","c_or_name","onRemove","removeComponents","getComponents","getComponent","_clip","origin","target","isObject","isEmpty","toJSON","type","et","entityType","cloneDeep","cs","Component","_singleton","_nameReadOnly","entity","_entity","getName","_name","setName","getSignleton","getEntity","Factory","destory","info","C","component","console","log","eval","factories","EntityManager","__parseConfigInfo","bArray","_processors","_factories","_entityTypes","_pools","_entities","_entitiesByName","addFactory","init","addComponents","addProcessors","processors","addFactories","addProcessor","notAlias","addEntityType","addEntityTypes","f","removeFactory","factory","p","removeProcessor","processor","createEntity","_opts","merge","addEntity","createEntityChildren","removeEntityChildren","_e","getEntityById","eid","getEntities","selector","entities","and","or","rlist","rspace","del","split","update","delta","process","sprintf","sprintfWrapper","RegExp","string","exp","matches","strings","convCount","stringPosStart","stringPosEnd","matchPosEnd","newString","match","exec","lastIndex","substring","left","sign","pad","precision","code","negative","parseInt","argument","String","substitution","abs","toString","convert","fromCharCode","parseFloat","toFixed","toUpperCase","nosign","join","replace"],"mappings":"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","sourceRoot":"/","sourcesContent":["var jm = jm || {};\r\nvar _ = require(\"lodash\");\r\n(function () {\r\n    if (jm.root) return;\r\n    jm.root = {};\r\n    jm.root.registries = {};\r\n})();\r\n\r\nmodule.exports = jm;\n(function(){\r\n    if(jm.Class) return;\r\n    var fnTest = /xyz/.test(function(){xyz;}) ? /\\b_super\\b/ : /.*/;\r\n\r\n    // The base Class implementation (does nothing)\r\n    jm.Class = function(){};\r\n\r\n    // Create a new Class that inherits from this class\r\n    jm.Class.extend = function(prop) {\r\n        var _super = this.prototype;\r\n\r\n        // Instantiate a base class (but only create the instance,\r\n        // don't run the init constructor)\r\n        var prototype = Object.create(_super);\r\n\r\n        // Copy the properties over onto the new prototype\r\n        for (var name in prop) {\r\n            if(name == 'properties'){\r\n                continue;\r\n            }\r\n            // Check if we're overwriting an existing function\r\n            prototype[name] = typeof prop[name] == \"function\" &&\r\n                typeof _super[name] == \"function\" && fnTest.test(prop[name]) ?\r\n                (function(name, fn){\r\n                    return function() {\r\n                        var tmp = this._super;\r\n\r\n                        // Add a new ._super() method that is the same method\r\n                        // but on the super-class\r\n                        this._super = _super[name];\r\n\r\n                        // The method only need to be bound temporarily, so we\r\n                        // remove it when we're done executing\r\n                        var ret = fn.apply(this, arguments);\r\n                        this._super = tmp;\r\n\r\n                        return ret;\r\n                    };\r\n                })(name, prop[name]) :\r\n                prop[name];\r\n        }\r\n\r\n        {\r\n            var properties = prop['properties'];\r\n            for(var key in properties){\r\n                var desc = properties[key];\r\n                if(desc.get && typeof desc.get == \"string\"){\r\n                    desc.get = prototype[desc.get];\r\n                }\r\n                if(desc.set && typeof desc.set == \"string\"){\r\n                    desc.set = prototype[desc.set];\r\n                }\r\n                Object.defineProperty(prototype, key, desc);\r\n            }\r\n        }\r\n\r\n        // The dummy class constructor\r\n        function Class() {\r\n            if(this._className){\r\n                Object.defineProperty(this, \"className\", { value: this._className, writable: false });\r\n            }\r\n\r\n            // All construction is actually done in the init method\r\n            if ( this.ctor )\r\n                this.ctor.apply(this, arguments);\r\n        }\r\n\r\n        // Populate our constructed prototype object\r\n        Class.prototype = prototype;\r\n\r\n        // Enforce the constructor to be what we expect\r\n        Class.prototype.constructor = Class;\r\n\r\n        // And make this class extendable\r\n        Class.extend = jm.Class.extend;\r\n\r\n        return Class;\r\n    };\r\n})();\r\n\n(function(){\r\n    if(jm.Object) return;\r\n    jm.Object = jm.Class.extend({\r\n        _className: 'object',\r\n        attr: function (attrs) {\r\n            for (var key in attrs) {\r\n                if(key === 'className'){\r\n                    continue;\r\n                }\r\n                this[key] = attrs[key];\r\n            }\r\n        }\r\n    });\r\n\r\n    jm.object = function(){\r\n        return new jm.Object();\r\n    };\r\n})();\r\n\n(function(){\r\n    if(jm.Random) return;\r\n    var iRandomMax = 200000000000;    // 0 <= randomValue <= iRandomMax;\r\n\r\n    jm.Random = jm.Class.extend({\r\n        _className: 'random',\r\n\r\n        properties: {\r\n            seed: { get: 'getSeed', set: 'setSeed' }\r\n        },\r\n\r\n        ctor: function(opts){\r\n            opts = opts || {};\r\n            this.g_seed = 0;\r\n            this.randomMax =  opts.randomMax || iRandomMax;            \r\n        },\r\n\r\n        setSeed : function(seed)\r\n        {\r\n            this.g_seed = seed;\r\n        },\r\n\r\n        getSeed : function()\r\n        {\r\n            return this.g_seed;\r\n        },\r\n\r\n        random : function(){\r\n            this.g_seed = ( this.g_seed * 9301 + 49297 ) % 233280;\r\n            return this.g_seed / ( 233280.0 );\r\n        },\r\n\r\n        //min<=result<=max\r\n        randomInt : function(min, max)\r\n        {\r\n            if(max === undefined) {\r\n                max = min;\r\n                min = 0;\r\n            }\r\n            var range = min + (this.random()*(max - min));\r\n            return Math.round(range);\r\n        },\r\n\r\n        //min<=result<=max\r\n        randomDouble : function(min, max)\r\n        {\r\n            if(max === undefined) {\r\n                max = min;\r\n                min = 0.0;\r\n            }\r\n\r\n            var range = min + (this.random()*(max - min));\r\n            return range;\r\n        },\r\n\r\n        randomRange : function(range){\r\n            return this.randomInt(0,this.randomMax) % range;\r\n        },\r\n\r\n        randomOdds : function(range, odds){\r\n            if(this.randomRange(range) < odds) return 1;\r\n            return 0;\r\n        }\r\n    });\r\n\r\n    jm.random = function(opts){\r\n        return new jm.Random(opts);\r\n    };\r\n\r\n})();\r\n\n(function () {\r\n    if (jm.EventEmitter) return;\r\n    jm.EventEmitter = jm.Object.extend({\r\n        _className: 'eventEmitter',\r\n        ctor: function () {\r\n            this._events = {};\r\n            this._persistEvents = {};\r\n            this.addListener = this.on;\r\n        },\r\n        __createListener: function (fn, caller) {\r\n            caller = caller;\r\n            return {\r\n                fn: fn,\r\n                caller: caller\r\n            };\r\n        },\r\n        __equalsListener: function (listener1, listener2) {\r\n            return listener1.fn === listener2.fn && listener1.caller === listener2.caller;\r\n        },\r\n        /**\r\n         * Adds a listener\r\n         * @api public\r\n         */\r\n        on: function (name, fn, caller) {\r\n            var listener = this.__createListener(fn, caller);\r\n            if (!this._events[name]) {\r\n                this._events[name] = listener;\r\n            } else if (Array.isArray(this._events[name])) {\r\n                this._events[name].push(listener);\r\n            } else {\r\n                this._events[name] = [this._events[name], listener];\r\n            }\r\n            return this;\r\n        },\r\n        onPersist: function (name, fn, caller) {\r\n            var listener = this.__createListener(fn, caller);\r\n            if (!this._persistEvents[name]) {\r\n                this._persistEvents[name] = listener;\r\n            } else if (Array.isArray(this._persistEvents[name])) {\r\n                this._persistEvents[name].push(listener);\r\n            } else {\r\n                this._persistEvents[name] = [this._persistEvents[name], listener];\r\n            }\r\n            return this;\r\n        },\r\n        /**\r\n         * Adds a volatile listener.\r\n         * @api public\r\n         */\r\n\r\n        once: function (name, fn, caller) {\r\n            var self = this;\r\n            var listener = this.__createListener(fn, caller);\r\n\r\n            function on(arg1, arg2, arg3, arg4, arg5) {\r\n                self.removeListener(name, on);\r\n                fn.call(listener.caller, arg1, arg2, arg3, arg4, arg5);\r\n            };\r\n            on.listener = listener;\r\n            this.on(name, on);\r\n            return this;\r\n        },\r\n        /**\r\n         * Removes a listener.\r\n         * @api public\r\n         */\r\n\r\n        removeListener: function (name, fn, caller) {\r\n            var listener = this.__createListener(fn, caller);\r\n            if (this._events && this._events[name]) {\r\n                var list = this._events[name];\r\n                if (Array.isArray(list)) {\r\n                    var pos = -1;\r\n                    for (var i = 0, l = list.length; i < l; i++) {\r\n                        var o = list[i];\r\n                        if (this.__equalsListener(o, listener) || (o.listener && this.__equalsListener(o.listener, listener))) {\r\n                            pos = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (pos < 0) {\r\n                        return this;\r\n                    }\r\n                    list.splice(pos, 1);\r\n                    if (!list.length) {\r\n                        delete this._events[name];\r\n                    }\r\n                } else if (this.__equalsListener(list, listener) || (list.listener && this.__equalsListener(list.listener, listener))) {\r\n                    delete this._events[name];\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        removePersistListener: function (name, fn, caller) {\r\n            var listener = this.__createListener(fn, caller);\r\n            if (this._persistEvents && this._persistEvents[name]) {\r\n                var list = this._persistEvents[name];\r\n                if (Array.isArray(list)) {\r\n                    var pos = -1;\r\n                    for (var i = 0, l = list.length; i < l; i++) {\r\n                        var o = list[i];\r\n                        if (this.__equalsListener(o, listener) || (o.listener && this.__equalsListener(o.listener, listener))) {\r\n                            pos = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (pos < 0) {\r\n                        return this;\r\n                    }\r\n                    list.splice(pos, 1);\r\n                    if (!list.length) {\r\n                        delete this._persistEvents[name];\r\n                    }\r\n                } else if (this.__equalsListener(list, listener) || (list.listener && this.__equalsListener(list.listener, listener))) {\r\n                    delete this._persistEvents[name];\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        //NODE\r\n        delListener: function (caller) {\r\n            for (var name in  this._events) {\r\n                var list = this._events[name];\r\n                if (!Array.isArray(list)) {\r\n                    list = [list];\r\n                }\r\n                list = list.concat();\r\n                for (var i in list) {\r\n                    var listener = list[i];\r\n                    if (listener.caller && listener.fn && listener.caller === caller) {\r\n                        this.removeListener(name, listener.fn, caller);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * Removes all listeners for an event.\r\n         * @api public\r\n         */\r\n\r\n        removeAllListeners: function (name) {\r\n            if (name === undefined) {\r\n                this._events = {};\r\n                return this;\r\n            }\r\n            if (this._events && this._events[name]) {\r\n                //this._events[name] = null;\r\n                delete this._events[name];\r\n            }\r\n            return this;\r\n        },\r\n        /**\r\n         * Gets all listeners for a certain event.\r\n         *\r\n         * @api publci\r\n         */\r\n\r\n        listeners: function (name) {\r\n            if (!this._events[name]) {\r\n                this._events[name] = [];\r\n            }\r\n            if (!Array.isArray(this._events[name])) {\r\n                this._events[name] = [this._events[name]];\r\n            }\r\n            return this._events[name];\r\n        },\r\n        /**\r\n         * Emits an event.\r\n         *\r\n         * tip: use arg1...arg5 instead of arguments for performance consider.\r\n         *\r\n         * @api public\r\n         */\r\n\r\n        emit: function (name, arg1, arg2, arg3, arg4, arg5) {\r\n            this._emitPersist(name, arg1, arg2, arg3, arg4, arg5);\r\n            var handler = this._events[name];\r\n            if (!handler) return this;\r\n            if (typeof handler === 'object' && !Array.isArray(handler)) {\r\n                handler.fn.call(handler.caller || this, arg1, arg2, arg3, arg4, arg5);\r\n            } else if (Array.isArray(handler)) {\r\n                var listeners = new Array(handler.length);\r\n                for (var i = 0; i < handler.length; i++) {\r\n                    listeners[i] = handler[i];\r\n                }\r\n                for (var i = 0, l = listeners.length; i < l; i++) {\r\n                    var h = listeners[i];\r\n                    if (h.fn.call(h.caller || this, arg1, arg2, arg3, arg4, arg5) === false) break;\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        _emitPersist: function (name, arg1, arg2, arg3, arg4, arg5) {\r\n            var handler = this._persistEvents[name];\r\n            if (!handler) return this;\r\n            if (typeof handler === 'object' && !Array.isArray(handler)) {\r\n                handler.fn.call(handler.caller || this, arg1, arg2, arg3, arg4, arg5);\r\n            } else if (Array.isArray(handler)) {\r\n                var listeners = new Array(handler.length);\r\n                for (var i = 0; i < handler.length; i++) {\r\n                    listeners[i] = handler[i];\r\n                }\r\n                for (var i = 0, l = listeners.length; i < l; i++) {\r\n                    var h = listeners[i];\r\n                    if (h.fn.call(h.caller || this, arg1, arg2, arg3, arg4, arg5) === false) break;\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    });\r\n    jm.eventEmitter = function () {\r\n        var event = new jm.EventEmitter();\r\n        event.off = event.removeListener;\r\n        return event;\r\n    }\r\n    var prototype = jm.EventEmitter.prototype;\r\n    var EventEmitter = {\r\n        _events: {},\r\n        _persistEvents: {},\r\n        delListener: prototype.delListener,\r\n        removePersistListener: prototype.removePersistListener,\r\n        _emitPersist: prototype._emitPersist,\r\n        __createListener: prototype.__createListener,\r\n        __equalsListener: prototype.__equalsListener,\r\n        on: prototype.on,\r\n        once: prototype.once,\r\n        onPersist: prototype.onPersist,\r\n        addListener: prototype.on,\r\n        removeListener: prototype.removeListener,\r\n        removeEventListener: prototype.removeListener,\r\n        off: prototype.removeListener,\r\n        removeAllListeners: prototype.removeAllListeners,\r\n        listeners: prototype.listeners,\r\n        emit: prototype.emit\r\n    };\r\n    var em = EventEmitter;\r\n    jm.enableEvent = function (obj) {\r\n        if (obj._events !== undefined) return;\r\n        for (var key in em) {\r\n            obj[key] = em[key];\r\n        }\r\n        obj._events = {};\r\n        return this;\r\n    };\r\n    jm.disableEvent = function (obj) {\r\n        for (var key in em) {\r\n            delete obj[key];\r\n        }\r\n        return this;\r\n    };\r\n})();\r\n\n(function(){\r\n    if(jm.TagObject) return;\r\n    jm.TagObject = jm.EventEmitter.extend({\r\n        _className: 'tagObject',\r\n\r\n        ctor: function(){\r\n            this._super();\r\n            this._tags = [];\r\n            Object.defineProperty(this, \"tags\", { value: this._tags, writable: false });\r\n        },\r\n\r\n        destroy: function(){\r\n            this.emit('destroy', this);\r\n            this.removeAllTags();\r\n        },\r\n\r\n        hasTag: function(tag){\r\n            var tags = this._tags;\r\n            return tags.indexOf(tag) != -1;\r\n        },\r\n\r\n        hasTagAny: function(tags){\r\n            for(var i in tags){\r\n                var t = tags[i];\r\n                if(this.hasTag(t)) return true;\r\n            }\r\n            return false;\r\n        },\r\n\r\n        hasTagAll: function(tags){\r\n            for(var i in tags){\r\n                var t = tags[i];\r\n                if(!this.hasTag(t)) return false;\r\n            }\r\n            return true;\r\n        },\r\n\r\n        addTag: function(tag){\r\n            var tags = this._tags;\r\n            if (this.hasTag(tag)) return this;\r\n            tags.push(tag);\r\n            this.emit('addTag', tag);\r\n            return this;\r\n        },\r\n\r\n        addTags: function(tags){\r\n            for(var i in tags){\r\n                var t = tags[i];\r\n                this.addTag(t);\r\n            }\r\n            return this;\r\n        },\r\n\r\n        removeTag: function(tag){\r\n            var tags = this._tags;\r\n            var idx = tags.indexOf(tag);\r\n            if(idx>=0){\r\n                tags.splice(idx, 1);\r\n            }\r\n            this.emit('removeTag', tag);\r\n            return this;\r\n        },\r\n\r\n        removeTags: function(tags){\r\n            for(var i in tags){\r\n                var t = tags[i];\r\n                this.removeTag(t);\r\n            }\r\n            return this;\r\n        },\r\n\r\n        removeAllTags: function () {\r\n            var v = this._tags;\r\n            for(i in v){\r\n                this.emit('removeTag', v[i]);\r\n            }\r\n            this._tags = [];\r\n            this.emit('removeAllTags');\r\n            return this;\r\n        }\r\n\r\n    });\r\n\r\n    jm.tagObject = function(){return new jm.TagObject();}\r\n\r\n    var prototype = jm.TagObject.prototype;\r\n    var Tag = {\r\n        _tags: [],\r\n        hasTag: prototype.hasTag,\r\n        hasTagAny: prototype.hasTagAny,\r\n        hasTagAll: prototype.hasTagAll,\r\n        addTag: prototype.addTag,\r\n        addTags: prototype.addTags,\r\n        removeTag: prototype.removeTag,\r\n        removeTags: prototype.removeTags,\r\n        removeAllTags: prototype.removeAllTags\r\n    };\r\n    jm.enableTag = function(obj) {\r\n        if(obj._tags!=undefined) return;\r\n        for(var key in Tag){\r\n            obj[key] = Tag[key];\r\n        }\r\n        obj._tags = [];\r\n        Object.defineProperty(obj, \"tags\", { value: obj._tags, writable: false });\r\n        jm.enableEvent(obj);\r\n    };\r\n    jm.disableTag = function(obj) {\r\n        for(var key in Tag){\r\n            delete obj[key];\r\n        }\r\n        jm.disableEvent(obj);\r\n    };\r\n})();\r\n\n(function () {\n    if (jm.Entity) return;\n    var guid = 1;\n\n    function isEmptyObject(e) {\n        var t;\n        for (t in e)\n            return false;\n        return true;\n    }\n\n    jm.Entity = jm.TagObject.extend({\n        _className: 'entity',\n\n        ctor: function (entityManager) {\n            this._super();\n\n            this.entityManager = entityManager;\n            this._components = {};\n            this._componentsByClass = {};\n            this._componentGUID = 1;\n\n            this.active = true;\n            this.entityId = guid++;\n\n            Object.defineProperty(this, \"components\", {value: this._components, writable: false});\n            Object.defineProperty(this, \"componentsByClass\", {value: this._componentsByClass, writable: false});\n\n            this.on('addTag', function (tag) {\n                entityManager._entitiesByTag[tag] = entityManager._entitiesByTag[tag] || {};\n                entityManager._entitiesByTag[tag][this.entityId] = this;\n            });\n            this.on('removeTag', function (tag) {\n                var o = entityManager._entitiesByTag[tag];\n                if (!o) return;\n                delete o[this.entityId];\n                if (isEmptyObject(o))\n                    delete entityManager._entitiesByTag[tag];\n            });\n        },\n\n        destroy: function () {\n            this.emit('destroy', this);\n            this.removeAllComponents();\n            this.removeAllTags();\n        },\n\n        removeChild: function (e) {\n            this.entityManager.removeEntity(e.entityId);\n            this.children = _.without(this.children, e);\n            e.destroy();\n        },\n\n        removeFromParent: function () {\n            this.removeAllTags();\n            if (this.parent) {\n                this.parent.removeChild(this);\n            } else {\n                this.entityManager.removeEntity(this.entityId);\n            }\n        },\n\n        addComponent: function (c) {\n            var components = this._components;\n            var componentsByClass = this._componentsByClass;\n            var name = c.name;\n            var cClassName = c.className;\n\n            var bUsedName = (name in components );\n            if (bUsedName) {\n                if (c.singleton) {\n                    if (bUsedName) throw \"componen already exists with the name: \" + name;\n                }\n                name = cClassName + this._componentGUID++;\n                c.name = name;\n            }\n\n            if (cClassName in componentsByClass) {\n            } else {\n                componentsByClass[cClassName] = {};\n            }\n            var vByClass = componentsByClass[cClassName];\n\n            components[name] = c;\n            vByClass[name] = c;\n            this[name] = c;\n            this.addTag(cClassName);\n            if (c.classAlias) this.addTag(c.classAlias);\n\n            c.onAdd(this);\n            c.emit('add', this);\n            this.emit('addComponent', c);\n\n            return this;\n        },\n\n        removeComponent: function (c_or_name) {\n            var components = this._components;\n            var componentsByClass = this._componentsByClass;\n            var c = c_or_name;\n            if (typeof c == 'string') {\n                c = components[c];\n            }\n            if (!c) return this;\n            var name = c.name;\n            var cClassName = c.className;\n            var v = componentsByClass[cClassName];\n            delete components[name];\n            delete v[name];\n            delete this[name];\n            this.removeTag(cClassName);\n\n            c.onRemove(this);\n            c.emit('remove', this);\n            this.emit('removeComponent', c);\n            c.destroy();\n            return this;\n        },\n\n        removeComponents: function (className) {\n            var v = this.getComponents(className);\n            for (i in v) {\n                this.removeComponent(i);\n            }\n            delete this._componentsByClass[className];\n            this.emit('removeComponents', className);\n            return this;\n        },\n\n        removeAllComponents: function () {\n            var v = this._components;\n            for (i in v) {\n                this.removeComponent(i);\n            }\n            this.emit('removeAllComponents');\n            return this;\n        },\n\n        getComponent: function (name) {\n            return this._components[name];\n        },\n\n        getComponents: function (className) {\n            return this._componentsByClass[className];\n        },\n\n        /**\n         * entityType\n         */\n        _clip: function (origin, target) {\n            if (!origin) {\n                return;\n            }\n\n            var obj = target;\n\n            for (var key in target) {\n                var t = target[key];\n                var o = origin[key];\n                if (_.isObject(t)) {\n                    if (o) {\n                        this._clip(o, t);\n                    }\n                    if (_.isEmpty(t)) {\n                        delete target[key];\n                    }\n                    continue;\n                }\n\n                if (t === o) {\n                    delete target[key];\n                }\n            }\n        },\n\n        toJSON: function () {\n            var em = this.entityManager;\n            var type = this.type;\n            var et = em.entityType(type);\n\n            var opts = {\n                type: type,\n                tags: [],\n                components: {}\n            };\n\n            opts.tags = _.cloneDeep(this.tags);\n            opts.tags = _.without(opts.tags, type);\n\n            var cs = opts.components;\n            var v = this.components;\n            for (i in v) {\n                var c = v[i];\n                cs[i] = c.toJSON();\n                opts.tags = _.without(opts.tags, i, c.className);\n                if (c.classAlias) opts.tags = _.without(opts.tags, c.classAlias);\n                if (i === cs[i].className)\n                    delete cs[i].className;\n            }\n\n            for (i in et.tags) {\n                opts.tags = _.without(opts.tags, et.tags[i]);\n            }\n            if (!opts.tags.length) delete opts.tags;\n\n            //entityType\n            this._clip(et, opts);\n\n            v = this.children;\n            for (i in v) {\n                var e = v[i];\n                if (!opts.children) opts.children = [];\n                opts.children.push(e.toJSON());\n            }\n\n            return opts;\n        }\n\n    });\n})();\n(function () {\n    if (jm.Component) return;\n    jm.Component = jm.TagObject.extend({\n        _className: 'component',\n        _singleton: true,\n        _nameReadOnly: false,\n        properties: {\n            singleton: {get: 'getSignleton'},\n            entity: {get: 'getEntity'},\n            name: {get: 'getName', set: 'setName'}\n        },\n\n        ctor: function (entity, opts) {\n            this._super();\n            this._entity = entity;\n            this.active = true;\n            if (opts) this.attr(opts);\n        },\n\n        destroy: function () {\n        },\n\n        /**\n         * on added to an entity\n         * @param e\n         */\n        onAdd: function (e) {\n        },\n\n        /**\n         * on removed from an entity\n         * @param e\n         */\n        onRemove: function (e) {\n        },\n\n        getName: function () {\n            return this._name || this.classAlias || this.className;\n        },\n\n        setName: function (name) {\n            if (this._nameReadOnly) return;\n            this._name = name;\n        },\n\n        getSignleton: function () {\n            return this._singleton;\n        },\n\n        getEntity: function () {\n            return this._entity;\n        },\n\n        toJSON: function () {\n            return {\n                className: this.classAlias || this.className\n            };\n        }\n\n    });\n\n    jm.root.registries.components = {\n        'component': jm.Component\n    };\n\n    jm.Component.extend = function (opts) {\n        var Class = jm.Class.extend.call(this, opts);\n        Class.extend = jm.Component.extend;\n        jm.root.registries.components[Class.prototype._className] = Class;\n        return Class;\n    };\n\n})();\n(function () {\r\n    if (jm.Factory) return;\r\n    jm.Factory = jm.EventEmitter.extend({\r\n        _className: 'factory',\r\n\r\n        ctor: function (entityManager, opts) {\r\n            this._super(opts);\r\n            this.entityManager = entityManager;\r\n        },\r\n\r\n        destory: function () {\r\n            this.emit('destroy', this);\r\n            this._super();\r\n        },\r\n\r\n        create: function (opts) {\r\n            var e = new jm.Entity(this.entityManager);\r\n            if (!opts || !opts.components) return e;\r\n            if (opts.parent) {\r\n                e.parent = opts.parent;\r\n            }\r\n\r\n            var c;\r\n            var em = this.entityManager;\r\n            for (var name in opts.components) {\r\n                var info = opts.components[name];\r\n                var className = name;\r\n                if (info.className)\r\n                    className = info.className;\r\n                var C = em.component(className);\r\n                if (!C) {\r\n                    C = jm.root.registries.components[className];\r\n                    if (C) {\r\n                        em.addComponent(C, className);\r\n                    } else {\r\n                        console.log(className)\r\n                        C = eval(className);\r\n                        if (C) {\r\n                            C = jm.root.registries.components[C.prototype._className];\r\n                        }\r\n                        if (C) {\r\n                            em.addComponent(C, className, true);\r\n                        } else {\r\n                            em.emit('warn', 'can not find component ' + className + ', ignored');\r\n                            continue;\r\n                        }\r\n                    }\r\n                }\r\n                c = new C(e, info);\r\n                if (info.className)\r\n                    c.name = name;\r\n                e.addComponent(c);\r\n            }\r\n            this.emit('create', e);\r\n            return e;\r\n        }\r\n\r\n    });\r\n\r\n\r\n    jm.root.registries.factories = {\r\n        'factory': jm.Factory\r\n    };\r\n    jm.Factory.extend = function (opts) {\r\n        var Class = jm.Class.extend.call(this, opts);\r\n        Class.extend = jm.Factory.extend;\r\n        jm.root.registries.factories[Class.prototype._className] = Class;\r\n        return Class;\r\n    };\r\n})();\n(function () {\n    if (jm.EntityManager) return;\n    var __parseConfigInfo = function (opts, key) {\n        var bArray = Array.isArray(opts);\n        var className, name;\n        if (bArray) {\n            className = opts[key];\n            name = null;\n        } else {\n            className = key;\n            name = opts[key];\n        }\n\n        return {className: className, name: name};\n    };\n\n    jm.EntityManager = jm.EventEmitter.extend({\n        _className: 'entityManager',\n\n        ctor: function (opts) {\n            this._super();\n\n            this._components = {};\n            this._processors = {};\n            this._factories = {};\n            this._entityTypes = {};\n            this._pools = {};\n\n            this._entities = {};\n            this._entitiesByName = {};\n            this._entitiesByTag = {};\n\n            Object.defineProperty(this, \"components\", {value: this._components, writable: false});\n            Object.defineProperty(this, \"processors\", {value: this._processors, writable: false});\n            Object.defineProperty(this, \"factories\", {value: this._factories, writable: false});\n            Object.defineProperty(this, \"entityTypes\", {value: this._entityTypes, writable: false});\n            Object.defineProperty(this, \"pools\", {value: this._pools, writable: false});\n\n            Object.defineProperty(this, \"entities\", {value: this._entities, writable: false});\n            Object.defineProperty(this, \"entitiesByName\", {value: this._entitiesByName, writable: false});\n            Object.defineProperty(this, \"entitiesByTag\", {value: this._entitiesByTag, writable: false});\n\n            var v = jm.root.registries.factories;\n            for (var key in v) {\n                var o = new v[key](this);\n                this.addFactory(o, key);\n            }\n\n            this.init(opts)\n        },\n\n        init: function (opts) {\n            if (!opts) return;\n            this.addComponents(opts.components);\n            this.addProcessors(opts.processors);\n            this.addFactories(opts.factories);\n        },\n\n        addComponents: function (opts) {\n            var bArray = _.isArray(opts);\n            for (var key in opts) {\n                var info = __parseConfigInfo(opts, key);\n                var C = eval(info.className);\n                this.addComponent(C, info.className, true);\n                this.addComponent(C, info.name);\n            }\n            return this;\n        },\n\n        addProcessors: function (opts) {\n            for (var key in opts) {\n                var info = __parseConfigInfo(opts, key);\n                var o = eval('new ' + info.className + '(this)');\n                if (info.name) {\n                    this.addProcessor(o, info.name);\n                } else {\n                    this.addProcessor(o, info.className);\n                }\n            }\n            return this;\n        },\n\n        addFactories: function (opts) {\n            for (var key in opts) {\n                var info = __parseConfigInfo(opts, key);\n                var o = eval('new ' + info.className + '(this)');\n                this.addFactory(o, info.className);\n                this.addFactory(o, info.name);\n            }\n            return this;\n        },\n\n        addComponent: function (C, name, notAlias) {\n            if (!C) return this;\n            if (!name) {\n                name = C.prototype._className;\n            } else {\n                if (!notAlias) {\n                    if (name != C.prototype._className) {\n                        C.prototype.classAlias = name;\n                    }\n                }\n            }\n            if (this._components[name]) {\n                this.emit('warn', 'add Compoent already exists for ' + name + ', replaced.');\n            }\n            this._components[name] = C;\n            this.emit('addComponent', name);\n            return this;\n        },\n\n        removeComponent: function (name) {\n            var components = this._components;\n            var o = components[name];\n            if (o) {\n                this.emit('removeComponent', name);\n            }\n            delete components[name];\n            return this;\n        },\n\n        component: function (name) {\n            return this._components[name];\n        },\n\n        addEntityType: function (type, opts) {\n            if (this._entityTypes[type]) {\n                this.emit('warn', 'add entityType already exists for ' + type + ', replaced.');\n            }\n\n            this._entityTypes[type] = opts;\n        },\n\n        addEntityTypes: function (opts) {\n            for (var type in opts) {\n                this.addEntityType(type, opts[type]);\n            }\n        },\n\n        entityType: function (type) {\n            return this._entityTypes[type];\n        },\n\n        addFactory: function (f, name) {\n            if (!f) return this;\n            name = name || f.name || f.className;\n\n            if (this._factories[name]) {\n                this.emit('warn', 'add factory already exists for ' + name + ', replaced.');\n            }\n\n            this._factories[name] = f;\n            if (f.entityManager != this)\n                f.entityManager = this;\n            this.emit('addFactory', f);\n\n            return this;\n        },\n\n        removeFactory: function (name) {\n            var factories = this._factories;\n            var f = factories[name];\n            if (f) {\n                this.emit('removeFactory', f);\n                delete factories[name];\n                f.destroy();\n            }\n            return this;\n        },\n\n        factory: function (name) {\n            return this._factories[name];\n        },\n\n        addProcessor: function (p, name) {\n            if (!p) return this;\n            if (!name)\n                name = p.name || p.className;\n\n            if (this._processors[name]) {\n                this.emit('warn', 'add processor already exists for ' + name + ', replaced.');\n            }\n\n            this._processors[name] = p;\n            if (p.entityManager != this)\n                p.entityManager = this;\n            this.emit('addProcessor', p);\n\n            return this;\n        },\n\n        removeProcessor: function (name) {\n            var processors = this._processors;\n            var p = processors[name];\n\n            if (p) {\n                this.emit('removeProcessor', p);\n                delete processors[name];\n                p.destroy();\n            }\n\n            return this;\n        },\n\n        processor: function (name) {\n            return this._processors[name];\n        },\n\n        //__createEntityFromPool: function (type, opts, parent) {\n        //    if (!this._entityTypes[type].poolable) return null;\n        //    if (parent) return null;\n        //    if (opts && opts.parent) return null;\n        //    if (this._pools[type]) {\n        //        var e = this._pools[type].shift();\n        //        if (e) {\n        //            e.emit('reuse', opts);\n        //            this.addEntity(e);\n        //            return e;\n        //        }\n        //    }\n        //    return null;\n        //},\n\n        createEntity: function (type, opts, parent) {\n            var e = null;\n\n            var _opts = opts;\n            opts = {};\n            opts = _.cloneDeep(this._entityTypes[type]); //\n            if (_opts) {\n                opts = _.merge(opts, _.cloneDeep(_opts)); //\n            }\n\n            var name = opts.factory || 'factory';\n            var f = this._factories[name];\n            if (!f) return null;\n            if (parent) opts.parent = parent;\n            e = f.create(opts);\n            if (!e) {\n                return null;\n            }\n\n            e.type = type;\n            e.addTag(type);\n            e.addTags(opts.tags);\n            this.addEntity(e);\n\n            this.createEntityChildren(e, opts);\n\n            return e;\n        },\n\n        createEntityChildren: function (e, opts) {\n            //create Children\n            for (var i in opts.children) {\n                var info = opts.children[i];\n                if (!info) continue;\n                var o = null;\n                var className = info.className || 'jm.Entity';\n                if (className == 'jm.Entity') {\n                    var type = info.type;\n                    o = this.createEntity(type, info, e);\n                }\n                if (!e.children) {\n                    e.children = [];\n                }\n                e.children.push(o);\n            }\n        },\n\n        addEntity: function (e, tag) {\n            if (!e || !e.entityId) {\n                return this;\n            }\n\n            if (tag) {\n                e.addTag(tag);\n            }\n\n            this._entities[e.entityId] = e;\n            if (e.name) {\n                this._entitiesByName[e.name] = e;\n            }\n\n            e.emit('add', this);\n            this.emit('addEntity', e);\n\n            return this;\n        },\n        //\n        //__removeEntityToPool: function (e) {\n        //    var type = e.type;\n        //    if (!this._entityTypes[type].poolable) return false;\n        //    if (e.parent) return false;\n        //    //? \n        //    if (!this._pools[type]) this._pools[type] = [];\n        //    var pool = this._pools[type];\n        //    e.emit('unuse');\n        //    pool.push(e);\n        //    return true;\n        //},\n        //\n        //clearPool: function (type) {\n        //    var pool = this._pools[type];\n        //    if (!pool) return;\n        //    this._pools[type] = [];\n        //    pool.forEach(function (e) {\n        //        e.destroy();\n        //    });\n        //},\n        //\n        //clearPools: function () {\n        //    for (var type in this._pools) {\n        //        this.clearPool(type);\n        //    }\n        //},\n\n        removeEntity: function (entityId) {\n            var e;\n            if (_.isObject(entityId)) {\n                e = entityId;\n            } else {\n                e = this._entities[entityId];\n            }\n            if (!e) {\n                return this;\n            }\n\n            this.removeEntityChildren(e);\n\n            e.emit('remove', this);\n            this.emit('removeEntity', e);\n            delete this._entities[e.entityId];\n\n            if (e.name) {\n                delete this._entitiesByName[e.name];\n            }\n\n            //if (this.__removeEntityToPool(e)) {\n            //    return this;\n            //} else {\n            //    e.destroy();\n            //}\n            e.destroy();\n            return this;\n        },\n\n        removeEntityChildren: function (e) {\n            var v = e.children;\n            for (var i in v) {\n                var _e = v[i];\n                this.removeEntity(_e.entityId);\n            }\n        },\n\n        getEntityById: function (eid) {\n            return this._entities[eid];\n        },\n//    getEntities('render')\n//    getEntities('render move tag1')  and\n//    getEntities('render, move, tag1')   or\n        getEntities: function (selector) {\n            var entities = this._entities;\n            if (!selector) return entities;\n            var v = {};\n            //select entities by tags\n            if (typeof selector === 'string') {\n                var and = false, //flags for multiple\n                    or = false;\n\n                var rlist = /\\s*,\\s*/;\n                var rspace = /\\s+/;\n                var del;\n                //multiple components OR\n                if (selector.indexOf(',') !== -1) {\n                    or = true;\n                    del = rlist;\n                } else if (selector.indexOf(' ') !== -1) {\n                    and = true;\n                    del = rspace;\n                }\n                if (!and && !or) {\n                    return this._entitiesByTag[selector];\n                }\n                var tags = selector.split(del);\n                var e;\n                for (var entityId in entities) {\n                    e = entities[entityId];\n                    if (and) {\n                        if (!e.hasTagAll(tags)) continue;\n                    } else if (or) {\n                        if (!e.hasTagAny(tags)) continue;\n                    }\n                    v[entityId] = e;\n                }\n            }\n\n            return v;\n        },\n\n        getEntity: function (selector) {\n            var v = this.getEntities(selector);\n            for (var i in v) {\n                return v[i];\n            }\n            return null;\n        },\n\n        update: function (delta) {\n            this.emit('update', delta);\n            var processors = this._processors;\n            for (var name in processors) {\n                var p = processors[name];\n                p.process(delta);\n            }\n        }\n\n    });\n\n    jm.entityManager = function (opts) {\n        return new jm.EntityManager(opts);\n    }\n})();\n(function () {\r\n    if (jm.sprintf)return;\r\n    var sprintfWrapper = {\r\n        init: function () {\r\n            if (typeof arguments == 'undefined') {\r\n                return null;\r\n            }\r\n            if (arguments.length < 1) {\r\n                return null;\r\n            }\r\n            if (typeof arguments[0] != 'string') {\r\n                return null;\r\n            }\r\n            if (typeof RegExp == 'undefined') {\r\n                return null;\r\n            }\r\n            var string = arguments[0];\r\n            var exp = new RegExp(/(%([%]|(\\-)?(\\+|\\x20)?(0)?(\\d+)?(\\.(\\d)?)?([bcdfosxX])))/g);\r\n            var matches = new Array();\r\n            var strings = new Array();\r\n            var convCount = 0;\r\n            var stringPosStart = 0;\r\n            var stringPosEnd = 0;\r\n            var matchPosEnd = 0;\r\n            var newString = '';\r\n            var match;\r\n            while (match = exp.exec(string)) {\r\n                if (match[9]) {\r\n                    convCount += 1;\r\n                }\r\n                stringPosStart = matchPosEnd;\r\n                stringPosEnd = exp.lastIndex - match[0].length;\r\n                strings[strings.length] = string.substring(stringPosStart, stringPosEnd);\r\n                matchPosEnd = exp.lastIndex;\r\n                matches[matches.length] = {\r\n                    match: match[0],\r\n                    left: match[3] ? true : false,\r\n                    sign: match[4] || '',\r\n                    pad: match[5] || ' ',\r\n                    min: match[6] || 0,\r\n                    precision: match[8],\r\n                    code: match[9] || '%',\r\n                    negative: parseInt(arguments[convCount]) < 0 ? true : false,\r\n                    argument: String(arguments[convCount])\r\n                };\r\n            }\r\n            strings[strings.length] = string.substring(matchPosEnd);\r\n            if (matches.length == 0) {\r\n                return string;\r\n            }\r\n            if ((arguments.length - 1) < convCount) {\r\n                return null;\r\n            }\r\n            for (var i = 0; i < matches.length; i++) {\r\n                var substitution;\r\n                if (matches[i].code == '%') {\r\n                    substitution = '%'\r\n                }\r\n                else if (matches[i].code == 'b') {\r\n                    matches[i].argument = String(Math.abs(parseInt(matches[i].argument)).toString(2));\r\n                    substitution = sprintfWrapper.convert(matches[i], true);\r\n                }\r\n                else if (matches[i].code == 'c') {\r\n                    matches[i].argument = String(String.fromCharCode(parseInt(Math.abs(parseInt(matches[i].argument)))));\r\n                    substitution = sprintfWrapper.convert(matches[i], true);\r\n                }\r\n                else if (matches[i].code == 'd') {\r\n                    matches[i].argument = String(Math.abs(parseInt(matches[i].argument)));\r\n                    substitution = sprintfWrapper.convert(matches[i]);\r\n                }\r\n                else if (matches[i].code == 'f') {\r\n                    matches[i].argument = String(Math.abs(parseFloat(matches[i].argument)).toFixed(matches[i].precision ? matches[i].precision : 6));\r\n                    substitution = sprintfWrapper.convert(matches[i]);\r\n                }\r\n                else if (matches[i].code == 'o') {\r\n                    matches[i].argument = String(Math.abs(parseInt(matches[i].argument)).toString(8));\r\n                    substitution = sprintfWrapper.convert(matches[i]);\r\n                }\r\n                else if (matches[i].code == 's') {\r\n                    matches[i].argument = matches[i].argument.substring(0, matches[i].precision ? matches[i].precision : matches[i].argument.length)\r\n                    substitution = sprintfWrapper.convert(matches[i], true);\r\n                }\r\n                else if (matches[i].code == 'x') {\r\n                    matches[i].argument = String(Math.abs(parseInt(matches[i].argument)).toString(16));\r\n                    substitution = sprintfWrapper.convert(matches[i]);\r\n                }\r\n                else if (matches[i].code == 'X') {\r\n                    matches[i].argument = String(Math.abs(parseInt(matches[i].argument)).toString(16));\r\n                    substitution = sprintfWrapper.convert(matches[i]).toUpperCase();\r\n                }\r\n                else {\r\n                    substitution = matches[i].match;\r\n                }\r\n                newString += strings[i];\r\n                newString += substitution;\r\n            }\r\n            newString += strings[i];\r\n            return newString;\r\n        },\r\n        convert: function (match, nosign) {\r\n            if (nosign) {\r\n                match.sign = '';\r\n            } else {\r\n                match.sign = match.negative ? '-' : match.sign;\r\n            }\r\n            var l = match.min - match.argument.length + 1 - match.sign.length;\r\n            var pad = new Array(l < 0 ? 0 : l).join(match.pad);\r\n            if (!match.left) {\r\n                if (match.pad == '0' || nosign) {\r\n                    return match.sign + pad + match.argument;\r\n                } else {\r\n                    return pad + match.sign + match.argument;\r\n                }\r\n            } else {\r\n                if (match.pad == '0' || nosign) {\r\n                    return match.sign + match.argument + pad.replace(/0/g, ' ');\r\n                } else {\r\n                    return match.sign + match.argument + pad;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    jm.sprintf = sprintfWrapper.init;\r\n\r\n})();\r\n\r\n\r\n\r\n"]}